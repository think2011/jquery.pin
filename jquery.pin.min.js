(function(a){a.fn.pin=function(e){var h=0,b=[],f=false,i=a(window);e=e||{};var c=function(){for(var l=0,j=b.length;l<j;l++){var n=b[l];if(e.minWidth&&i.width()<=e.minWidth){if(n.parent().is(".pin-wrapper")){n.unwrap()}n.css({width:"",left:"",top:"",position:""});f=true;continue}else{f=false}var p=e.containerSelector?n.closest(e.containerSelector):a(document.body);var o=n.offset();var m=p.offset();var k=n.offsetParent().offset();if(!n.parent().is(".pin-wrapper")){n.wrap("<div class='pin-wrapper'>")}n.data("pin",{from:e.containerSelector?m.top:o.top,to:m.top+p.height()-n.outerHeight(),end:m.top+p.height(),parentTop:k.top});n.css({width:n.outerWidth()});if(!e.isFloat){n.parent().css("height",n.outerHeight())}}};var d=function(){if(f){return}h=i.scrollTop();for(var k=0,j=b.length;k<j;k++){var m=a(b[k]),l=m.data("pin"),o=l.from,n=l.to;if(o+m.outerHeight()>l.end){m.css("position","");continue}if(o<h&&n>h){!(m.css("position")=="fixed")&&m.css({left:m.offset().left,top:0}).css("position","fixed")}else{if(h>=n){m.css({left:"auto",top:n-l.parentTop}).css("position","absolute")}else{m.css({position:"",top:"",left:""})}}}};var g=function(){c();d()};this.each(function(){var k=a(this),j=a(this).data("pin")||{};if(j&&j.update){return}b.push(k);a("img",this).one("load",c);j.update=g;a(this).data("pin",j)});i.scroll(d);i.resize(function(){c()});c();i.load(g);return this}})(jQuery);